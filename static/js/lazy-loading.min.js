(function(){'use strict';const config ={rootMargin:'50px',threshold:0.01,loadingClass:'lazy-loading',loadedClass:'lazy-loaded',errorClass:'lazy-error'};function loadImage(img){const src = img.dataset.src;const srcset = img.dataset.srcset;if(!src)return;img.classList.add(config.loadingClass);const tempImg = new Image();tempImg.onload = function(){img.src = src;if(srcset){img.srcset = srcset;}delete img.dataset.src;delete img.dataset.srcset;img.classList.remove(config.loadingClass);img.classList.add(config.loadedClass);img.dispatchEvent(new CustomEvent('lazyloaded',{bubbles:true,detail:{src:src}}));};tempImg.onerror = function(){img.classList.remove(config.loadingClass);img.classList.add(config.errorClass);img.dispatchEvent(new CustomEvent('lazyerror',{bubbles:true,detail:{src:src}}));console.error('Erro ao carregar imagem lazy:',src);};tempImg.src = src;if(srcset){tempImg.srcset = srcset;}}function loadBackgroundImage(element){const bg = element.dataset.bg;if(!bg)return;element.classList.add(config.loadingClass);const tempImg = new Image();tempImg.onload = function(){element.style.backgroundImage = `url('${bg}')`;delete element.dataset.bg;element.classList.remove(config.loadingClass);element.classList.add(config.loadedClass);element.dispatchEvent(new CustomEvent('lazyloaded',{bubbles:true,detail:{bg:bg}}));};tempImg.onerror = function(){element.classList.remove(config.loadingClass);element.classList.add(config.errorClass);console.error('Erro ao carregar background lazy:',bg);};tempImg.src = bg;}function initLazyLoading(){if(!('IntersectionObserver' in window)){console.warn('IntersectionObserver n√£o suportado. Carregando todas as imagens...');loadAllImages();return;}const observer = new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){if(entry.isIntersecting){const element = entry.target;if(element.tagName === 'IMG'){loadImage(element);}else if(element.dataset.bg){loadBackgroundImage(element);}observer.unobserve(element);}});},{rootMargin:config.rootMargin,threshold:config.threshold});const lazyImages = document.querySelectorAll('img[data-src]');lazyImages.forEach(function(img){observer.observe(img);});const lazyBackgrounds = document.querySelectorAll('[data-bg]');lazyBackgrounds.forEach(function(element){observer.observe(element);});console.log(`Lazy loading inicializado:${lazyImages.length}imagens,${lazyBackgrounds.length}backgrounds`);}function loadAllImages(){const lazyImages = document.querySelectorAll('img[data-src]');lazyImages.forEach(loadImage);const lazyBackgrounds = document.querySelectorAll('[data-bg]');lazyBackgrounds.forEach(loadBackgroundImage);}window.LazyLoader ={init:initLazyLoading,loadImage:loadImage,loadBackgroundImage:loadBackgroundImage,loadAll:loadAllImages};if(document.readyState === 'loading'){document.addEventListener('DOMContentLoaded',initLazyLoading);}else{initLazyLoading();}})();